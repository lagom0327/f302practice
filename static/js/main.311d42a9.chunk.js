(this["webpackJsonptest-app"]=this["webpackJsonptest-app"]||[]).push([[0],{29:function(n,t,e){},37:function(n,t,e){"use strict";e.r(t);var r=e(1),c=e(0),i=e(20),o=e.n(i),a=(e(29),e(9)),u=e(3),s=e(10),b=e(4),j=e(2),d="token",l=function(n){localStorage.setItem(d,n)},f=function(){return localStorage.getItem(d)},h="https://student-json-api.lidemy.me",O=function(){var n=f();return fetch("".concat(h,"/me"),{headers:{authorization:"Bearer ".concat(n)}}).then((function(n){return n.json()}))};function x(){var n=Object(u.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]);return x=function(){return n},n}function p(){var n=Object(u.a)(["\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n"]);return p=function(){return n},n}function g(){var n=Object(u.a)(["\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  paddiing: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n"]);return g=function(){return n},n}function v(){var n=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]);return v=function(){return n},n}var m=j.b.div(v()),w=j.b.div(g()),y=Object(j.b)(s.b)(p()),S=j.b.div(x());function k(n){var t=n.post;return Object(r.jsxs)(w,{children:[Object(r.jsx)(y,{to:"/posts/".concat(t.id),children:t.title}),Object(r.jsx)(S,{children:new Date(t.createdAt).toLocaleDateString()})]})}function z(){var n=Object(c.useState)([]),t=Object(a.a)(n,2),e=t[0],i=t[1];return Object(c.useEffect)((function(){fetch("".concat(h,"/posts?_sort=createdAt&_order=desc")).then((function(n){return n.json()})).then((function(n){return i(n)}))}),[]),Object(r.jsx)(m,{children:e.map((function(n){return Object(r.jsx)(k,{post:n},n.id)}))})}var C=Object(c.createContext)(null);function E(){var n=Object(c.useState)(""),t=Object(a.a)(n,2),e=t[0],i=t[1],o=Object(c.useState)(""),u=Object(a.a)(o,2),s=u[0],j=u[1],d=Object(c.useState)(),f=Object(a.a)(d,2),x=f[0],p=f[1],g=Object(c.useContext)(C).setUser,v=Object(b.f)();return Object(r.jsxs)("form",{onSubmit:function(n){n.preventDefault(),p(null),function(n,t){return fetch("".concat(h,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:n,password:t})}).then((function(n){return n.json()}))}(e,s).then((function(n){if(console.log(n),0===n.ok)return p(n.message);l(n.token),O().then((function(n){if(1!==n.ok)return l(null),p(n.message);g(n.data),v.push("/")}))}))},children:[Object(r.jsxs)("div",{children:["username:"," ",Object(r.jsx)("input",{value:e,onChange:function(n){i(n.target.value)}})]}),Object(r.jsxs)("div",{children:["password:"," ",Object(r.jsx)("input",{type:"password",value:s,onChange:function(n){j(n.target.value)}})]}),Object(r.jsx)("button",{children:"\u767b\u5165"}),x&&Object(r.jsx)("div",{children:x})]})}function D(){var n=Object(u.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]);return D=function(){return n},n}var $=j.b.div(D());function A(){var n=Object(u.a)(["\n  margin-top: 16px;\n  color: red;\n"]);return A=function(){return n},n}function I(){var n=Object(u.a)(["\n  padding: 1rem 0;\n  margin: 0 auto;\n  overflow-wrap: break-word;\n"]);return I=function(){return n},n}function J(){var n=Object(u.a)(["\n  color: #333;\n"]);return J=function(){return n},n}function L(){var n=Object(u.a)(["\n  overflow-wrap: break-word;\n"]);return L=function(){return n},n}function U(){var n=Object(u.a)(["\n  // // display: flex;\n  // justify-content: space-between;\n  // align-items: center;\n  border-bottom: 1px solid #ccc;\n  padding: 1rem 0;\n"]);return U=function(){return n},n}function B(){var n=Object(u.a)(["\n  width: 80%;\n  max-width: 900px;\n  min-height: 80vh;\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 0 32px;\n  margin: 1rem auto;\n  box-sizing: border-box;\n  position: relative;\n  border-radius: 5px;\n  // padding: 1.5rem;\n"]);return B=function(){return n},n}var P=j.b.div(B()),_=j.b.div(U()),F=j.b.h1(L()),N=j.b.div(J()),T=j.b.div(I()),q=j.b.div(A());function G(){var n=Object(b.h)().id,t=Object(c.useState)(!1),e=Object(a.a)(t,2),i=e[0],o=e[1],u=Object(c.useState)(null),s=Object(a.a)(u,2),j=s[0],d=s[1];return Object(c.useEffect)((function(){o(!1),d(null),function(n){return fetch("".concat(h,"/posts?id=").concat(n)).then((function(n){return n.json()}))}(n).then((function(n){if(!n[0])return o("\u6c92\u6709\u9019\u500b id");d(n[0])})).catch((function(n){o(n.message)}))}),[n]),Object(r.jsxs)(P,{children:[!j&&!i&&Object(r.jsx)($,{children:"Loading ..."}),!j&&i&&Object(r.jsxs)(q,{children:["Something went wrong. ",i.toString()]}),j&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(_,{children:[Object(r.jsx)(F,{children:j.title}),Object(r.jsx)(N,{children:new Date(j.createdAt).toLocaleString()})]}),Object(r.jsx)(T,{children:j.body})]})]})}function H(){var n=Object(u.a)(["\n  display: flex;\n  align-items: center;\n  height: 100%;\n  "," {\n    margin-left: 64px;\n  }\n"]);return H=function(){return n},n}function K(){var n=Object(u.a)(["\n  // border: 1px solid black;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  box-sizing: border-box;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n\n  ","\n"]);return K=function(){return n},n}function M(){var n=Object(u.a)(["\n  display: flex;\n  aligin-items: center;\n  height: 100%;\n  // height: 64px;\n"]);return M=function(){return n},n}function Q(){var n=Object(u.a)(["\n  font-size: 32px;\n  font-weight: bold;\n"]);return Q=function(){return n},n}function R(){var n=Object(u.a)(["\n  height: 64px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 0 32px;\n  box-sizing: border-box;\n"]);return R=function(){return n},n}var V=j.b.div(R()),W=j.b.div(Q()),X=j.b.div(M()),Y=Object(j.b)(s.b)(K(),(function(n){return n.$active&&"\n    background: rgba(0, 0, 0, 0.2);\n  "})),Z=j.b.div(H(),X);function nn(){var n=Object(c.useContext)(C),t=n.user,e=n.setUser,i=Object(b.f)(),o=Object(b.g)();console.log("/",Object(b.i)("/"));return Object(r.jsxs)(V,{children:[Object(r.jsxs)(Z,{children:[Object(r.jsx)(W,{children:"\u6211\u7684\u7b2c\u4e00\u500b\u90e8\u843d\u683c"}),Object(r.jsxs)(X,{children:[Object(r.jsx)(Y,{to:"/",$active:Object(b.i)("/").isExact,children:"\u9996\u9801"}),t&&Object(r.jsx)(Y,{to:"/new-post",$active:"/new-post"===o.pathname,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),Object(r.jsxs)(X,{children:[!t&&Object(r.jsx)(Y,{to:"/login",$active:"/login"===o.pathname,children:"\u767b\u5165"}),t&&Object(r.jsx)(Y,{onClick:function(){l(""),e(null),"/"!==o.pathname&&i.push("/")},children:"\u767b\u51fa"})]})]})}function tn(){var n=Object(u.a)(["\n  padding-top: 64px;\n"]);return tn=function(){return n},n}var en=j.b.div(tn());var rn=function(){var n=Object(c.useState)(null),t=Object(a.a)(n,2),e=t[0],i=t[1];return Object(c.useEffect)((function(){f()&&O().then((function(n){n.ok&&i(n.data)}))}),[]),Object(r.jsx)(C.Provider,{value:{user:e,setUser:i},children:Object(r.jsx)(en,{children:Object(r.jsxs)(s.a,{children:[Object(r.jsx)(nn,{}),Object(r.jsxs)(b.c,{children:[Object(r.jsx)(b.a,{exact:!0,path:"/",children:Object(r.jsx)(z,{})}),Object(r.jsx)(b.a,{exact:!0,path:"/login",children:Object(r.jsx)(E,{})}),Object(r.jsx)(b.a,{exact:!0,path:"/posts/:id",children:Object(r.jsx)(G,{})})]})]})})})};e(36);o.a.render(Object(r.jsx)(j.a,{theme:{colors:{secondary:{300:"#3333dd",400:"#d84646",500:"#b92121"}}},children:Object(r.jsx)(rn,{})}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.311d42a9.chunk.js.map